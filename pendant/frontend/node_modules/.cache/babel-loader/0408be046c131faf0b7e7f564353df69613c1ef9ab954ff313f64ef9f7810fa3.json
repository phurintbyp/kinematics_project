{"ast":null,"code":"import React,{useState,useEffect,useCallback}from'react';import axios from'axios';import JogControl from'./components/JogControl';import PositionDisplay from'./components/PositionDisplay';import'./App.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const App=()=>{const[jointPositions,setJointPositions]=useState({base_rotation:0,shoulder_rotation:0,prismatic_extension:0,elbow_rotation:0,wrist_rotation:0,end_effector_rotation:0});const[eePosition,setEePosition]=useState({x:0,y:0,z:0,roll:0,pitch:0,yaw:0});const[websocket,setWebsocket]=useState(null);const[connected,setConnected]=useState(false);const[error,setError]=useState(null);// Initialize WebSocket connection\nuseEffect(()=>{const ws=new WebSocket(`ws://${window.location.hostname}:8000/ws`);ws.onopen=()=>{console.log('WebSocket connected');setConnected(true);setError(null);};ws.onmessage=event=>{const data=JSON.parse(event.data);if(data.type==='position_update'){setJointPositions(data.joint_positions);setEePosition(data.ee_position);}};ws.onerror=error=>{console.error('WebSocket error:',error);setError('Failed to connect to the robot control server');setConnected(false);};ws.onclose=()=>{console.log('WebSocket disconnected');setConnected(false);};setWebsocket(ws);// Clean up the WebSocket connection when the component unmounts\nreturn()=>{if(ws){ws.close();}};},[]);// Fetch initial positions from the API\nuseEffect(()=>{const fetchPositions=async()=>{try{const[jointRes,eeRes]=await Promise.all([axios.get('/api/joint_positions'),axios.get('/api/ee_position')]);setJointPositions(jointRes.data);setEePosition(eeRes.data);}catch(error){console.error('Error fetching positions:',error);setError('Failed to fetch robot positions');}};fetchPositions();},[]);// Handle emergency stop\nconst handleEmergencyStop=async()=>{try{await axios.post('/api/emergency_stop');console.log('Emergency stop activated');}catch(error){console.error('Error activating emergency stop:',error);setError('Failed to activate emergency stop');}};// Send a message through the WebSocket\nconst sendWebSocketMessage=useCallback(message=>{if(websocket&&websocket.readyState===WebSocket.OPEN){websocket.send(JSON.stringify(message));}else{console.error('WebSocket is not connected');setError('WebSocket is not connected');}},[websocket]);return/*#__PURE__*/_jsxs(\"div\",{className:\"app\",children:[/*#__PURE__*/_jsxs(\"header\",{className:\"app-header\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Robot Arm Control\"}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"error-message\",children:error}),/*#__PURE__*/_jsxs(\"div\",{className:\"connection-status\",children:[\"Status: \",connected?'Connected':'Disconnected']}),/*#__PURE__*/_jsx(\"button\",{className:\"emergency-stop-button\",onClick:handleEmergencyStop,children:\"EMERGENCY STOP\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"app-content\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"left-panel\",children:/*#__PURE__*/_jsx(PositionDisplay,{jointPositions:jointPositions,eePosition:eePosition})}),/*#__PURE__*/_jsx(\"div\",{className:\"right-panel\",children:/*#__PURE__*/_jsx(JogControl,{sendWebSocketMessage:sendWebSocketMessage})})]})]});};export default App;","map":{"version":3,"names":["React","useState","useEffect","useCallback","axios","JogControl","PositionDisplay","jsx","_jsx","jsxs","_jsxs","App","jointPositions","setJointPositions","base_rotation","shoulder_rotation","prismatic_extension","elbow_rotation","wrist_rotation","end_effector_rotation","eePosition","setEePosition","x","y","z","roll","pitch","yaw","websocket","setWebsocket","connected","setConnected","error","setError","ws","WebSocket","window","location","hostname","onopen","console","log","onmessage","event","data","JSON","parse","type","joint_positions","ee_position","onerror","onclose","close","fetchPositions","jointRes","eeRes","Promise","all","get","handleEmergencyStop","post","sendWebSocketMessage","message","readyState","OPEN","send","stringify","className","children","onClick"],"sources":["/Users/phacharakimpha/kinematics_project/pendant/frontend/src/App.js"],"sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\nimport axios from 'axios';\nimport JogControl from './components/JogControl';\nimport PositionDisplay from './components/PositionDisplay';\nimport './App.css';\n\nconst App = () => {\n  const [jointPositions, setJointPositions] = useState({\n    base_rotation: 0,\n    shoulder_rotation: 0,\n    prismatic_extension: 0,\n    elbow_rotation: 0,\n    wrist_rotation: 0,\n    end_effector_rotation: 0\n  });\n  \n  const [eePosition, setEePosition] = useState({\n    x: 0,\n    y: 0,\n    z: 0,\n    roll: 0,\n    pitch: 0,\n    yaw: 0\n  });\n  \n  const [websocket, setWebsocket] = useState(null);\n  const [connected, setConnected] = useState(false);\n  const [error, setError] = useState(null);\n\n  // Initialize WebSocket connection\n  useEffect(() => {\n    const ws = new WebSocket(`ws://${window.location.hostname}:8000/ws`);\n    \n    ws.onopen = () => {\n      console.log('WebSocket connected');\n      setConnected(true);\n      setError(null);\n    };\n    \n    ws.onmessage = (event) => {\n      const data = JSON.parse(event.data);\n      if (data.type === 'position_update') {\n        setJointPositions(data.joint_positions);\n        setEePosition(data.ee_position);\n      }\n    };\n    \n    ws.onerror = (error) => {\n      console.error('WebSocket error:', error);\n      setError('Failed to connect to the robot control server');\n      setConnected(false);\n    };\n    \n    ws.onclose = () => {\n      console.log('WebSocket disconnected');\n      setConnected(false);\n    };\n    \n    setWebsocket(ws);\n    \n    // Clean up the WebSocket connection when the component unmounts\n    return () => {\n      if (ws) {\n        ws.close();\n      }\n    };\n  }, []);\n\n  // Fetch initial positions from the API\n  useEffect(() => {\n    const fetchPositions = async () => {\n      try {\n        const [jointRes, eeRes] = await Promise.all([\n          axios.get('/api/joint_positions'),\n          axios.get('/api/ee_position')\n        ]);\n        \n        setJointPositions(jointRes.data);\n        setEePosition(eeRes.data);\n      } catch (error) {\n        console.error('Error fetching positions:', error);\n        setError('Failed to fetch robot positions');\n      }\n    };\n    \n    fetchPositions();\n  }, []);\n\n  // Handle emergency stop\n  const handleEmergencyStop = async () => {\n    try {\n      await axios.post('/api/emergency_stop');\n      console.log('Emergency stop activated');\n    } catch (error) {\n      console.error('Error activating emergency stop:', error);\n      setError('Failed to activate emergency stop');\n    }\n  };\n\n  // Send a message through the WebSocket\n  const sendWebSocketMessage = useCallback((message) => {\n    if (websocket && websocket.readyState === WebSocket.OPEN) {\n      websocket.send(JSON.stringify(message));\n    } else {\n      console.error('WebSocket is not connected');\n      setError('WebSocket is not connected');\n    }\n  }, [websocket]);\n\n  return (\n    <div className=\"app\">\n      <header className=\"app-header\">\n        <h1>Robot Arm Control</h1>\n        {error && <div className=\"error-message\">{error}</div>}\n        <div className=\"connection-status\">\n          Status: {connected ? 'Connected' : 'Disconnected'}\n        </div>\n        <button \n          className=\"emergency-stop-button\" \n          onClick={handleEmergencyStop}\n        >\n          EMERGENCY STOP\n        </button>\n      </header>\n      \n      <div className=\"app-content\">\n        <div className=\"left-panel\">\n          <PositionDisplay \n            jointPositions={jointPositions} \n            eePosition={eePosition} \n          />\n        </div>\n        \n        <div className=\"right-panel\">\n          <JogControl \n            sendWebSocketMessage={sendWebSocketMessage}\n          />\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}